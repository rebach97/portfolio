<script>
  let currentSlide = 0;
  const slides = document.querySelectorAll('.story-item');
  const indicator = document.getElementById('progress-indicator');

  function showSlide(index) {
    slides.forEach((slide, i) => {
      slide.classList.toggle('active', i === index);
      if (i === index) adjustSlideHeight(slide);
    });
    indicator.textContent = `${index + 1} / ${slides.length}`;
  }

  function nextSlide() {
    currentSlide = (currentSlide + 1) % slides.length;
    showSlide(currentSlide);
  }

  function prevSlide() {
    currentSlide = (currentSlide - 1 + slides.length) % slides.length;
    showSlide(currentSlide);
  }

  function adjustSlideHeight(slide) {
    const minHeight = window.innerHeight * 0.7; // 70% of viewport
    // Reset to auto to measure content
    slide.style.minHeight = "auto";
    const contentHeight = slide.scrollHeight;
    // Set to larger of content height or 70vh
    slide.style.minHeight = Math.max(contentHeight, minHeight) + "px";
  }

  window.addEventListener('resize', () => {
    if (slides[currentSlide].classList.contains('active')) {
      adjustSlideHeight(slides[currentSlide]);
    }
  });

  showSlide(currentSlide);
</script>
